var ventana; $(document).ready(function() {ventana = $(window).width(); }); var app = angular.module('myApp', ['ui.bootstrap']); app.filter('startFrom', function() {return function(input, start) {if (input) {start = +start; return input.slice(start); } return []; } }); app.controller('post', function($scope, $http, $window) {$scope.rows = function() {$(".bg-preload").show(); $(".bg-list").hide(); if ($(window).width() > 762) {var req = {method: 'GET', url: $("#url").val() + '/getEventsByDate/' + $("#lang").val() + '/' + $("#category").val() + '/' + $("#date").val(), headers: {'Accept': 'application/json', 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;', 'x-api-key': 'rwWjQk8TPaJAcbDqi4i9TDTXWHxQzpqzdLnM5ttKYMmYpTjLp6'} } } else {var req = {method: 'GET', url: $("#url").val() + '/getEventsByCategories/' + $("#lang").val() + '/' + $("#category").val(), headers: {'Accept': 'application/json', 'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;', 'x-api-key': 'rwWjQk8TPaJAcbDqi4i9TDTXWHxQzpqzdLnM5ttKYMmYpTjLp6'} } } $http(req).then(function successCallback(response) {$scope.list = response.data; $scope.currentPage = 1; $scope.entryLimit = 50; $scope.filteredItems = $scope.list.length; $scope.totalItems = $scope.list.length; $(".bg-preload").hide(); $(".bg-list").show(); }); }; $scope.rows(); $scope.setPage = function(pageNo) {$scope.currentPage = pageNo; }; $scope.filter = function() {if ($("#search").val() == '') {$scope.filteredItems = $scope.list.length; $scope.totalItems = $scope.list.length; } else {$scope.filteredItems = $scope.filtered.length; $scope.totalItems = $scope.filtered.length; } }; $scope.sort_by = function(predicate) {$scope.predicate = predicate; $scope.reverse = !$scope.reverse; }; $scope.goToEvents = function(url) {if ($("#lang").val() == 'es') {window.location = $("#url").val() + '/es/agenda/' + url; } else {window.location = $("#url").val() + '/en/diary/' + url; } }; $scope.goToCategory = function(url) {if ($("#lang").val() == 'es') {window.location = $("#url").val() + '/es/agenda/' + url; } else {window.location = $("#url").val() + '/en/diary/' + url; } } }); function searchDate(date) {$("#date").val(date); angular.element($('[ng-controller="post"]')).scope().rows(); } var elems = document.querySelectorAll('.datepicker'); var instances = M.Datepicker.init(elems); $(document).ready(function() {if ($("#lang").val() == 'es') {$('.datepicker').datepicker({format: 'yyyy-mm-dd', closeOnSelect: true, i18n: {cancel: 'Volver a días', done: 'Seleccionar', months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'], monthsShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'], weekdays: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'], weekdaysShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'], weekdaysAbbrev: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'], }, onOpen: function() {$("#datepicker").val(''); }, onClose: function() {setDate(); } }); } else {$('.datepicker').datepicker({format: 'yyyy-mm-dd', closeOnSelect: true, i18n: {cancel: 'Back to day', done: 'Select', months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'], monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'], weekdays: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'], weekdaysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], weekdaysAbbrev: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], }, onOpen: function() {$("#datepicker").val(''); }, onClose: function() {setDate(); } }); } }); function setDate() {if ($("#datepicker").val() != "") {searchDate($("#datepicker").val()); } else {openDays(); } } function openMonth() {$('.datepicker').click(); $("#nav-date").hide(); $("#day").removeClass('btn-primary'); $("#day").addClass('btn-default'); $("#month").removeClass('btn-default'); $("#month").addClass('btn-primary'); } function openDays() {$("#nav-date").show(); $("#date").val(''); $("#datepicker").val(''); $("#month").removeClass('btn-primary'); $("#month").addClass('btn-default'); $("#day").removeClass('btn-default'); $("#day").addClass('btn-primary'); searchDate($("#firts_date").val()); } $(window).resize(function() {var browserZoomLevel = Math.round(window.devicePixelRatio * 100); if ($(window).width() < 762) {if (ventana != $(window).width() && $("#device").val() == 'desktop') {openDays(); } } else if ($(window).width() < 980) {if (ventana != $(window).width() && $("#device").val() == 'desktop') {openDays(); } } else {var change_window = $(window).width(); if (browserZoomLevel != 100 && change_window < ventana) {change_window = ventana; } if (browserZoomLevel <= 100 && change_window == ventana) {browserZoomLevel = 0; } if (ventana != change_window && browserZoomLevel == 100) {openDays(); } } });